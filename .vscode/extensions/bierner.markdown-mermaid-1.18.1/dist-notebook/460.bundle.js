(self.webpackChunkmarkdown_mermaid=self.webpackChunkmarkdown_mermaid||[]).push([[460],{9460:(e,t,s)=>{s.r(t),s.d(t,{diagram:()=>B});var a=s(1213),o=s(5625),r=s(4309),i=s(8046),n=s(3841),d=s(8003),l=s(5408);s(7856),s(7484),s(2890),s(9368),s(7967);const c="rect",p="rectWithTitle",g="statediagram",b="transition",h="parent",u="note",y="----parent",m="fill:none",f="fill: #333",w="text",x="normal";let T={},k=0;function S(e="",t=0,s="",a="----"){return`state-${e}${null!==s&&s.length>0?`${a}${s}`:""}-${t}`}const D=(e,t,s,o,r,n)=>{const d=s.id,l=null==(g=o[d])?"":g.classes?g.classes.join(" "):"";var g;if("root"!==d){let t=c;!0===s.start&&(t="start"),!1===s.start&&(t="end"),s.type!==a.a&&(t=s.type),T[d]||(T[d]={id:d,shape:t,description:i.d.sanitizeText(d,(0,i.g)()),classes:`${l} statediagram-state`});const o=T[d];s.description&&(Array.isArray(o.description)?(o.shape=p,o.description.push(s.description)):o.description.length>0?(o.shape=p,o.description===d?o.description=[s.description]:o.description=[o.description,s.description]):(o.shape=c,o.description=s.description),o.description=i.d.sanitizeTextOrArray(o.description,(0,i.g)())),1===o.description.length&&o.shape===p&&(o.shape=c),!o.type&&s.doc&&(i.l.info("Setting cluster for ",d,v(s)),o.type="group",o.dir=v(s),o.shape=s.type===a.b?"divider":"roundedWithTitle",o.classes=o.classes+" statediagram-cluster "+(n?"statediagram-cluster-alt":""));const r={labelStyle:"",shape:o.shape,labelText:o.description,classes:o.classes,style:"",id:d,dir:o.dir,domId:S(d,k),type:o.type,padding:15};if(s.note){const t={labelStyle:"",shape:"note",labelText:s.note.text,classes:"statediagram-note",style:"",id:d+"----note-"+k,domId:S(d,k,u),type:o.type,padding:15},a={labelStyle:"",shape:"noteGroup",labelText:s.note.text,classes:o.classes,style:"",id:d+y,domId:S(d,k,h),type:"group",padding:0};k++;const i=d+y;e.setNode(i,a),e.setNode(t.id,t),e.setNode(d,r),e.setParent(d,i),e.setParent(t.id,i);let n=d,l=t.id;"left of"===s.note.position&&(n=t.id,l=d),e.setEdge(n,l,{arrowhead:"none",arrowType:"",style:m,labelStyle:"",classes:"transition note-edge",arrowheadStyle:f,labelpos:"c",labelType:w,thickness:x})}else e.setNode(d,r)}t&&"root"!==t.id&&(i.l.trace("Setting node ",d," to be child of its parent ",t.id),e.setParent(d,t.id)),s.doc&&(i.l.trace("Adding nodes children "),$(e,s,s.doc,o,r,!n))},$=(e,t,s,o,r,n)=>{i.l.trace("items",s),s.forEach((s=>{switch(s.stmt){case a.c:case a.a:D(e,t,s,o,r,n);break;case a.S:{D(e,t,s.state1,o,r,n),D(e,t,s.state2,o,r,n);const a={id:"edge"+k,arrowhead:"normal",arrowTypeEnd:"arrow_barb",style:m,labelStyle:"",label:i.d.sanitizeText(s.description,(0,i.g)()),arrowheadStyle:f,labelpos:"c",labelType:w,thickness:x,classes:b};e.setEdge(s.state1.id,s.state2.id,a,k),k++}}}))},v=(e,t=a.e)=>{let s=t;if(e.doc)for(let t=0;t<e.doc.length;t++){const a=e.doc[t];"dir"===a.stmt&&(s=a.value)}return s},A={setConf:function(e){const t=Object.keys(e);for(const s of t)e[s]},getClasses:function(e,t){i.l.trace("Extracting classes"),t.db.clear();try{return t.parser.parse(e),t.db.extract(t.db.getRootDocV2()),t.db.getClasses()}catch(e){return e}},draw:function(e,t,s,p){i.l.info("Drawing state diagram (v2)",t),T={};let b=p.db.getDirection();void 0===b&&(b=a.D);const{securityLevel:h,state:u}=(0,i.g)(),y=u.nodeSpacing||50,m=u.rankSpacing||50;i.l.info(p.db.getRootDocV2()),p.db.extract(p.db.getRootDocV2()),i.l.info(p.db.getRootDocV2());const f=p.db.getStates(),w=new o.k({multigraph:!0,compound:!0}).setGraph({rankdir:v(p.db.getRootDocV2()),nodesep:y,ranksep:m,marginx:8,marginy:8}).setDefaultEdgeLabel((function(){return{}}));let x;D(w,void 0,p.db.getRootDocV2(),f,p.db,!0),"sandbox"===h&&(x=(0,r.Ys)("#i"+t));const k="sandbox"===h?(0,r.Ys)(x.nodes()[0].contentDocument.body):(0,r.Ys)("body"),S=k.select(`[id="${t}"]`),$=k.select("#"+t+" g");(0,n.r)($,w,["barb"],g,t);l.u.insertTitle(S,"statediagramTitleText",u.titleTopMargin,p.db.getDiagramTitle());const A=S.node().getBBox(),B=A.width+16,E=A.height+16;S.attr("class",g);const C=S.node().getBBox();(0,d.c)(S,E,B,u.useMaxWidth);const R=`${C.x-8} ${C.y-8} ${B} ${E}`;i.l.debug(`viewBox ${R}`),S.attr("viewBox",R);const V=document.querySelectorAll('[id="'+t+'"] .edgeLabel .label');for(const e of V){const t=e.getBBox(),s=document.createElementNS("http://www.w3.org/2000/svg",c);s.setAttribute("rx",0),s.setAttribute("ry",0),s.setAttribute("width",t.width),s.setAttribute("height",t.height),e.insertBefore(s,e.firstChild)}}},B={parser:a.p,db:a.d,renderer:A,styles:a.s,init:e=>{e.state||(e.state={}),e.state.arrowMarkerAbsolute=e.arrowMarkerAbsolute,a.d.clear()}}}}]);