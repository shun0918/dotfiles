"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.FalsePositiveApi = void 0;
const api_lient_1 = require("../../../common/api/api\u0421lient");
class FalsePositiveApi extends api_lient_1.SnykApiClient {
    report(falsePositive, user) {
        var _a;
        if (!((_a = falsePositive.content) === null || _a === void 0 ? void 0 : _a.length)) {
            throw new Error("False positive shouldn't be empty.");
        }
        if (!user.authenticatedId) {
            throw new Error('Unauthenticated users cannot report false positives.');
        }
        const payload = {
            topic: 'False Positive',
            message: falsePositive.message,
            feedbackOrigin: 'ide',
            context: {
                issueId: falsePositive.id,
                fileContents: falsePositive.content,
                startLine: falsePositive.startLine,
                endLine: falsePositive.endLine,
                primaryFilePath: falsePositive.primaryFilePath,
                userPublicId: user.authenticatedId,
                vulnName: falsePositive.rule,
            },
        };
        return this.post('feedback/sast', payload);
    }
}
exports.FalsePositiveApi = FalsePositiveApi;
//# sourceMappingURL=falsePositiveApi.js.map