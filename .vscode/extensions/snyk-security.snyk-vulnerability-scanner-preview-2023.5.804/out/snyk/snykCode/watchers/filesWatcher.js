"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const code_client_1 = require("@snyk/code-client");
function createFileWatcher(extension, workspace, supportedFiles) {
    const globPattern = `**/{${(0, code_client_1.getGlobPatterns)(supportedFiles).join(',')}}`;
    const watcher = workspace.createFileSystemWatcher(globPattern);
    const updateFiles = (filePath) => {
        extension.snykCodeOld.addChangedFile(filePath);
        void extension.runCodeScan(); // It's debounced, so not worries about concurrent calls
    };
    watcher.onDidChange((documentUri) => {
        updateFiles(documentUri.fsPath);
    });
    watcher.onDidDelete((documentUri) => {
        updateFiles(documentUri.fsPath);
    });
    watcher.onDidCreate((documentUri) => {
        updateFiles(documentUri.fsPath);
    });
    return watcher;
}
exports.default = createFileWatcher;
//# sourceMappingURL=filesWatcher.js.map