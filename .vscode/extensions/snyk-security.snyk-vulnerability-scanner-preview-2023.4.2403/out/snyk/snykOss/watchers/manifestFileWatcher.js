"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
// to be kept in sync with Snyk CLI support list
// copied from https://github.com/snyk/snyk/blob/93ec5896282e3ba1389dc5604589d2773a4bf517/src/lib/package-managers.ts#L21
var SUPPORTED_MANIFEST_FILES;
(function (SUPPORTED_MANIFEST_FILES) {
    SUPPORTED_MANIFEST_FILES["GEMFILE"] = "Gemfile";
    SUPPORTED_MANIFEST_FILES["GEMFILE_LOCK"] = "Gemfile.lock";
    SUPPORTED_MANIFEST_FILES["GEMSPEC"] = "*.gemspec";
    SUPPORTED_MANIFEST_FILES["PACKAGE_LOCK_JSON"] = "package-lock.json";
    SUPPORTED_MANIFEST_FILES["POM_XML"] = "pom.xml";
    SUPPORTED_MANIFEST_FILES["JAR"] = "*.jar";
    SUPPORTED_MANIFEST_FILES["WAR"] = "*.war";
    SUPPORTED_MANIFEST_FILES["BUILD_GRADLE"] = "build.gradle";
    SUPPORTED_MANIFEST_FILES["BUILD_GRADLE_KTS"] = "build.gradle.kts";
    SUPPORTED_MANIFEST_FILES["BUILD_SBT"] = "build.sbt";
    SUPPORTED_MANIFEST_FILES["YARN_LOCK"] = "yarn.lock";
    SUPPORTED_MANIFEST_FILES["PACKAGE_JSON"] = "package.json";
    SUPPORTED_MANIFEST_FILES["PIPFILE"] = "Pipfile";
    SUPPORTED_MANIFEST_FILES["SETUP_PY"] = "setup.py";
    SUPPORTED_MANIFEST_FILES["REQUIREMENTS_TXT"] = "requirements.txt";
    SUPPORTED_MANIFEST_FILES["GOPKG_LOCK"] = "Gopkg.lock";
    SUPPORTED_MANIFEST_FILES["GO_MOD"] = "go.mod";
    SUPPORTED_MANIFEST_FILES["VENDOR_JSON"] = "vendor.json";
    SUPPORTED_MANIFEST_FILES["PROJECT_ASSETS_JSON"] = "project.assets.json";
    SUPPORTED_MANIFEST_FILES["PACKAGES_CONFIG"] = "packages.config";
    SUPPORTED_MANIFEST_FILES["PROJECT_JSON"] = "project.json";
    SUPPORTED_MANIFEST_FILES["PAKET_DEPENDENCIES"] = "paket.dependencies";
    SUPPORTED_MANIFEST_FILES["COMPOSER_LOCK"] = "composer.lock";
    SUPPORTED_MANIFEST_FILES["PODFILE_LOCK"] = "Podfile.lock";
    SUPPORTED_MANIFEST_FILES["COCOAPODS_PODFILE_YAML"] = "CocoaPods.podfile.yaml";
    SUPPORTED_MANIFEST_FILES["COCOAPODS_PODFILE"] = "CocoaPods.podfile";
    SUPPORTED_MANIFEST_FILES["PODFILE"] = "Podfile";
    SUPPORTED_MANIFEST_FILES["POETRY_LOCK"] = "poetry.lock";
    SUPPORTED_MANIFEST_FILES["MIX_EXS"] = "mix.exs";
})(SUPPORTED_MANIFEST_FILES || (SUPPORTED_MANIFEST_FILES = {}));
function createManifestFileWatcher(extension, workspace, configuration) {
    const globPattern = `**/{${Object.values(SUPPORTED_MANIFEST_FILES).join(',')}}`;
    const watcher = workspace.createFileSystemWatcher(globPattern);
    watcher.onDidChange(() => runOssScan());
    watcher.onDidDelete(() => runOssScan());
    watcher.onDidCreate(() => runOssScan());
    function runOssScan() {
        if (configuration.shouldAutoScanOss) {
            void extension.runOssScan();
        }
    }
    return watcher;
}
exports.default = createManifestFileWatcher;
//# sourceMappingURL=manifestFileWatcher.js.map